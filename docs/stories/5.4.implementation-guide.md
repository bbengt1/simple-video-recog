# Story 5.4: Dashboard HTML/CSS Framework - Implementation Guide

**Quick Reference for Developers**

---

## ðŸŽ¯ Story Overview

**Goal:** Build the visual foundation for the web dashboard with responsive layout and dark mode design.

**Effort:** 7-8 hours (1 day)

**Priority:** HIGH (Foundation for all dashboard components)

**Depends On:** Story 5.1 (FastAPI server for static file serving)

---

## ðŸ“‹ Pre-Implementation Checklist

Before you start, verify:

- [ ] Story 5.1 is complete (FastAPI server running)
- [ ] Static file serving works (`http://localhost:8000/`)
- [ ] Placeholder index.html loads
- [ ] CSS directory exists (`web/css/`)
- [ ] JS directory exists (`web/js/`)
- [ ] Understanding of CSS Grid and Flexbox
- [ ] Browser DevTools available for testing

---

## ðŸš€ Quick Start

### 1. Backup Existing Files (5 min)

```bash
# Backup placeholder index.html
cp web/index.html web/index.html.bak

# Verify CSS directories exist
mkdir -p web/css web/js
```

### 2. Create File Structure (10 min)

```bash
# Create CSS files
touch web/css/main.css
touch web/css/layout.css
touch web/css/components.css

# Create minimal JS
touch web/js/app.js

# Verify structure
tree web/
# web/
# â”œâ”€â”€ css/
# â”‚   â”œâ”€â”€ main.css
# â”‚   â”œâ”€â”€ layout.css
# â”‚   â””â”€â”€ components.css
# â”œâ”€â”€ js/
# â”‚   â””â”€â”€ app.js
# â””â”€â”€ index.html
```

### 3. Implement Components (5-6 hours)

**Order of Implementation:**

1. **HTML Structure** (`web/index.html`) - 30 min
   - Copy HTML from specification
   - Add semantic structure
   - Define grid areas
   - Test: Page loads

2. **CSS Variables & Reset** (`web/css/main.css`) - 30 min
   - Define color palette
   - Set spacing scale
   - Add CSS reset
   - Test: Variables accessible

3. **Grid Layout** (`web/css/layout.css`) - 60 min
   - Create dashboard grid
   - Add responsive breakpoints
   - Implement sidebar collapse
   - Test: Layout responds

4. **Component Styles** (`web/css/components.css`) - 90 min
   - Style header and status indicators
   - Create event card styles
   - Build skeleton loaders
   - Add button styles
   - Create modal styles
   - Test: All components look correct

5. **Loading States** - 30 min
   - CSS spinner animation
   - Skeleton screens
   - Connection indicators
   - Test: Loading states visible

6. **Accessibility** - 30 min
   - ARIA labels
   - Focus indicators
   - Keyboard navigation
   - Test: Tab through page

7. **Performance** - 30 min
   - Inline critical CSS
   - Remove unused styles
   - Optimize selectors
   - Test: Load time <3s

8. **Browser Testing** - 30 min
   - Chrome, Safari, Firefox
   - Responsive layouts
   - Grid/Flexbox support
   - Test: Works everywhere

### 4. Manual Testing (1 hour)

```bash
# Terminal 1: Start web server
python web_server.py

# Browser: Open http://localhost:8000
# Test checklist from story document
```

### 5. Documentation (30 min)

- Update README with design system
- Document color palette
- Add component examples

---

## ðŸ”§ Implementation Details

### Critical: CSS Grid Layout

**Dashboard Layout Structure:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           HEADER (sticky)           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚      â”‚                  â”‚           â”‚
â”‚ SIDE â”‚   MAIN CONTENT   â”‚  METRICS  â”‚
â”‚ BAR  â”‚   (event feed)   â”‚  (health) â”‚
â”‚      â”‚                  â”‚           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚            FOOTER                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**CSS Grid Implementation:**

```css
.dashboard {
    display: grid;
    grid-template-rows: auto 1fr auto;  /* header, main, footer */
    grid-template-columns: auto 1fr auto;  /* sidebar, main, metrics */
    grid-template-areas:
        "header header header"
        "sidebar main metrics"
        "footer footer footer";
    min-height: 100vh;
}

.header { grid-area: header; }
.sidebar { grid-area: sidebar; }
.main-content { grid-area: main; }
.metrics-panel { grid-area: metrics; }
.footer { grid-area: footer; }
```

**Why CSS Grid?**
- Perfect for 2D dashboard layout
- Responsive without media query hacks
- Native browser support (Chrome 57+, Safari 10.1+, Firefox 52+)
- Cleaner than float/position

---

### Critical: Dark Mode Color Palette

**Color System:**

```css
:root {
    /* Backgrounds (darkest to lightest) */
    --bg-primary: #1a1a1a;     /* Main background */
    --bg-secondary: #2a2a2a;   /* Cards, header, footer */
    --bg-tertiary: #3a3a3a;    /* Hover states, borders */

    /* Text (lightest to darkest) */
    --text-primary: #e0e0e0;   /* Main text */
    --text-secondary: #b0b0b0; /* Secondary text */
    --text-tertiary: #808080;  /* Disabled, hints */

    /* Accents */
    --accent-primary: #2196f3;   /* Primary blue */
    --accent-success: #4caf50;   /* Green for success */
    --accent-warning: #ff9800;   /* Orange for warnings */
    --accent-error: #f44336;     /* Red for errors */
}
```

**WCAG AA Compliance:**

| Combination | Contrast Ratio | WCAG AA (4.5:1) |
|-------------|----------------|-----------------|
| `--text-primary` on `--bg-primary` | 9.8:1 | âœ… Pass |
| `--text-secondary` on `--bg-primary` | 6.2:1 | âœ… Pass |
| `--text-tertiary` on `--bg-primary` | 4.7:1 | âœ… Pass |

**Verify with DevTools:**
```javascript
// Chrome DevTools Console
// Select element, check "Contrast" in Accessibility panel
```

---

### Critical: Responsive Breakpoints

**Breakpoint Strategy:**

```css
/* Mobile-first approach, but minimum 1280px per NFR33 */

/* Base: 1280px - 1919px (Standard desktop) */
.dashboard { /* default styles */ }

/* Large: 1920px - 2559px (FHD displays) */
@media (max-width: 1920px) {
    .main-content { max-width: 1000px; }
}

/* XL: 2560px+ (4K displays) */
@media (min-width: 2560px) {
    .main-content { max-width: 1800px; }
    .metrics-panel { width: 400px; }
}

/* Compact: < 1280px (collapsible sidebar) */
@media (max-width: 1280px) {
    .sidebar {
        position: fixed;
        transform: translateX(-280px);  /* Hidden by default */
    }
    .sidebar.open {
        transform: translateX(0);  /* Show when opened */
    }
}
```

**Why These Breakpoints?**
- 1280px: NFR33 minimum width requirement
- 1920px: Most common desktop resolution (FHD)
- 2560px: 4K displays becoming common

---

### Critical: CSS-Only Icons

**Why No Icon Font or SVG Library?**
- Zero external dependencies
- Smaller file size
- No licensing concerns
- Instant load (no font download)

**Implementation:**

```css
/* Use Unicode symbols or pseudo-elements */
.icon-camera::before { content: "ðŸ“¹"; }
.icon-refresh::before { content: "â†»"; }
.icon-close::before { content: "âœ•"; }
.icon-chevron::before { content: "â€¹"; }

/* For shapes, use CSS borders */
.status-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: var(--accent-success);
}

/* For complex shapes, use ::before/::after */
.icon-hamburger::before,
.icon-hamburger::after {
    content: "";
    display: block;
    width: 20px;
    height: 2px;
    background: var(--text-primary);
    margin: 4px 0;
}
```

**Trade-off:** Less visual variety, but acceptable for MVP.

---

### Critical: Performance Optimization

**Inline Critical CSS:**

```html
<head>
    <!-- Critical CSS (inlined in <style> tag) -->
    <style>
        /* CSS variables */
        :root { /* ... */ }

        /* Reset */
        *, *::before, *::after { box-sizing: border-box; }

        /* Loading spinner (visible immediately) */
        .loading { /* ... */ }
        .spinner { /* ... */ }
        @keyframes spin { /* ... */ }
    </style>

    <!-- Non-critical CSS (loads after) -->
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/layout.css">
    <link rel="stylesheet" href="/css/components.css">
</head>
```

**Why Inline Critical CSS?**
- Prevents flash of unstyled content (FOUC)
- Faster First Contentful Paint (FCP)
- Critical CSS loads synchronously

**Measure Performance:**
```bash
# Chrome DevTools â†’ Lighthouse
# Target: Performance score >90
# Metrics:
# - FCP: <1.8s
# - LCP: <2.5s
# - CLS: <0.1
```

---

## âœ… Acceptance Criteria Checklist

### AC 1: HTML Structure
- [ ] Semantic HTML5 elements (header, nav, main, aside, footer)
- [ ] Header with title and status
- [ ] Main content area with grid
- [ ] Sidebar for filters (collapsible)
- [ ] Footer with version and status
- [ ] Proper meta tags

### AC 2: CSS Layout System
- [ ] CSS Grid for dashboard layout
- [ ] Flexbox for component layouts
- [ ] Responsive breakpoints (1280px, 1920px, 2560px)
- [ ] Mobile-first approach (min 1280px)
- [ ] No CSS frameworks

### AC 3: Dark Mode Design
- [ ] Dark color scheme applied
- [ ] High contrast colors
- [ ] CSS variables for colors
- [ ] WCAG AA compliance (4.5:1 text)
- [ ] Status colors (green/yellow/red)

### AC 4: Component Placeholder Areas
- [ ] Event feed area (left 2/3)
- [ ] Metrics area (right 1/3)
- [ ] Modal placeholder (hidden)
- [ ] Sidebar placeholder
- [ ] Header with status

### AC 5: Typography
- [ ] System font stack
- [ ] Font sizes: 14px, 16px, 18px, 24px, 32px
- [ ] Line heights (1.5 body, 1.2 headings)
- [ ] Monospace for timestamps
- [ ] Proper font weights

### AC 6: Loading States
- [ ] CSS spinner animation
- [ ] Skeleton screens for cards
- [ ] Connection status indicator
- [ ] Progress bars (if needed)
- [ ] Error state displays

### AC 7: Interactive Elements
- [ ] Button styles (primary, secondary)
- [ ] Form input styles
- [ ] Hover states
- [ ] Focus states
- [ ] Disabled states

### AC 8: Icons and Visual Elements
- [ ] CSS-only icons
- [ ] Status indicators (colored dots)
- [ ] Chevrons for expandable sections
- [ ] Loading spinner
- [ ] Placeholder shapes

### AC 9: Performance Optimization
- [ ] Minified CSS (manual acceptable)
- [ ] Critical CSS inlined
- [ ] Non-blocking CSS load
- [ ] No unused CSS
- [ ] Dashboard loads <3s

### AC 10: Accessibility
- [ ] Semantic HTML
- [ ] ARIA labels
- [ ] Keyboard navigation (tab order)
- [ ] Color contrast WCAG AA
- [ ] Focus indicators visible

### AC 11: Browser Compatibility
- [ ] Chrome 90+ works
- [ ] Safari 14+ works
- [ ] Firefox 88+ works
- [ ] CSS Grid/Flexbox supported
- [ ] No browser-specific hacks

### AC 12: Integration
- [ ] Replaces placeholder index.html
- [ ] Uses API endpoints (ready for data)
- [ ] WebSocket status indicator
- [ ] No breaking changes

---

## ðŸ§ª Testing Strategy

### Visual Testing (30 min)

**Checklist:**
```bash
# Open http://localhost:8000 in browser

# Visual inspection
âœ“ Dark background (#1a1a1a)
âœ“ Light text (#e0e0e0)
âœ“ Header sticky at top
âœ“ Sidebar on left (280px width)
âœ“ Main content in center
âœ“ Metrics panel on right (320px)
âœ“ Footer at bottom

# Component check
âœ“ Skeleton loaders visible
âœ“ Status indicator (green dot + "Connected")
âœ“ Metric cards (4 placeholders)
âœ“ Modal hidden by default
âœ“ Buttons styled correctly
```

---

### Responsive Testing (20 min)

```bash
# Chrome DevTools â†’ Device Toolbar

# Test breakpoints:
1. 1280px width
   âœ“ Sidebar becomes fixed (hidden by default)
   âœ“ Metrics panel 280px
   âœ“ Content readable

2. 1920px width
   âœ“ Standard layout
   âœ“ Max content width 1000px
   âœ“ Everything visible

3. 2560px width (4K)
   âœ“ Wider layout
   âœ“ Max content width 1800px
   âœ“ Metrics panel 400px
```

---

### Accessibility Testing (15 min)

```bash
# Keyboard navigation
1. Press Tab repeatedly
   âœ“ Focus moves logically (header â†’ sidebar â†’ main â†’ metrics â†’ footer)
   âœ“ Focus indicators visible (blue outline)
   âœ“ Skip to content link (optional)

2. Screen reader test (Mac: Cmd+F5 VoiceOver)
   âœ“ Headings read correctly
   âœ“ ARIA labels announced
   âœ“ Semantic structure clear

3. Color contrast (Chrome DevTools)
   âœ“ All text meets WCAG AA (4.5:1)
   âœ“ Check with Accessibility panel
```

---

### Performance Testing (15 min)

```bash
# Chrome DevTools â†’ Lighthouse
1. Run audit (Performance only)
   Target: Score >90

2. Check metrics:
   âœ“ FCP < 1.8s
   âœ“ LCP < 2.5s
   âœ“ CLS < 0.1

3. Network tab
   âœ“ index.html: <10KB
   âœ“ main.css: <20KB
   âœ“ layout.css: <10KB
   âœ“ components.css: <20KB
   âœ“ Total CSS: <50KB

4. Coverage tab
   âœ“ CSS coverage >80%
   âœ“ Remove unused rules
```

---

### Browser Compatibility Testing (20 min)

**Chrome 90+:**
```bash
# Should work perfectly (reference browser)
âœ“ Grid layout correct
âœ“ Flexbox correct
âœ“ CSS variables work
âœ“ Animations smooth
```

**Safari 14+:**
```bash
# Test on Mac or use BrowserStack
âœ“ Grid layout correct
âœ“ Flexbox correct
âœ“ CSS variables work
âœ“ Font rendering
âœ“ Scrolling smooth
```

**Firefox 88+:**
```bash
# Test in Firefox
âœ“ Grid layout correct
âœ“ Flexbox correct
âœ“ CSS variables work
âœ“ Scrollbar styling (differs from Chrome)
```

---

## ðŸš¨ Common Issues & Solutions

### Issue 1: "Grid layout broken in Safari"

**Symptom:**
Layout looks correct in Chrome, broken in Safari

**Diagnosis:**
```css
/* Check for `-webkit-` prefixes (usually not needed for Grid) */
/* Check grid-template-areas syntax */
```

**Solution:**
```css
/* Ensure proper grid syntax */
.dashboard {
    display: grid;
    /* Avoid minmax() with fr units in Safari */
    grid-template-rows: auto 1fr auto;  /* Simple, works everywhere */
}
```

---

### Issue 2: "Color contrast failing WCAG AA"

**Symptom:**
DevTools shows contrast ratio <4.5:1

**Diagnosis:**
```javascript
// Chrome DevTools â†’ Inspect element â†’ Accessibility panel
// Look for "Contrast" section
```

**Solution:**
```css
/* Adjust colors in CSS variables */
:root {
    /* BAD: Low contrast */
    --text-tertiary: #606060;  /* 3.2:1 on #1a1a1a background */

    /* GOOD: High contrast */
    --text-tertiary: #808080;  /* 4.7:1 on #1a1a1a background */
}
```

---

### Issue 3: "Dashboard loads slowly (>3s)"

**Symptom:**
Lighthouse Performance score <90

**Diagnosis:**
```bash
# Chrome DevTools â†’ Network tab
# Check CSS file sizes
# Check blocking resources
```

**Common Causes:**
- CSS files too large (>50KB total)
- Critical CSS not inlined
- Unused CSS rules

**Solution:**
```bash
# 1. Minify CSS
# Use online tool or:
npx csso web/css/main.css -o web/css/main.min.css

# 2. Remove unused CSS
# Chrome DevTools â†’ Coverage tab
# Identify and delete unused rules

# 3. Inline critical CSS
# Move above-the-fold styles to <style> tag in HTML
```

---

### Issue 4: "Layout shift on load (poor CLS score)"

**Symptom:**
Content jumps when page loads

**Diagnosis:**
```bash
# Lighthouse â†’ Performance
# Check Cumulative Layout Shift (CLS) metric
```

**Cause:** Images/components without explicit dimensions

**Solution:**
```css
/* Set explicit heights for skeleton loaders */
.skeleton-image {
    height: 200px;  /* Explicit height prevents shift */
    background: var(--bg-tertiary);
}

/* Use aspect-ratio for responsive images */
.event-image {
    aspect-ratio: 16 / 9;
    width: 100%;
}
```

---

### Issue 5: "Focus indicators invisible"

**Symptom:**
Can't see which element has focus when tabbing

**Solution:**
```css
/* Add visible focus styles */
*:focus {
    outline: 2px solid var(--accent-primary);
    outline-offset: 2px;
}

/* For custom focus styles */
.btn:focus {
    box-shadow: 0 0 0 3px rgba(33, 150, 243, 0.4);
}
```

---

## ðŸ“Š Success Metrics

| Metric | Target | How to Measure |
|--------|--------|----------------|
| Load time | <3s | Lighthouse Performance |
| CSS size | <50KB | Network tab (total CSS) |
| Text contrast | â‰¥4.5:1 | DevTools Accessibility panel |
| Lighthouse score | >90 | Lighthouse audit |
| FCP | <1.8s | Lighthouse metrics |
| LCP | <2.5s | Lighthouse metrics |
| CLS | <0.1 | Lighthouse metrics |
| Keyboard nav | 100% | Manual tab test |
| Browser compat | 100% | Test in 3 browsers |

---

## ðŸŽ“ Learning Resources

**CSS Grid:**
- CSS Tricks Guide: https://css-tricks.com/snippets/css/complete-guide-grid/
- MDN Grid: https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Grid_Layout

**Flexbox:**
- Flexbox Froggy (game): https://flexboxfroggy.com/
- CSS Tricks Guide: https://css-tricks.com/snippets/css/a-guide-to-flexbox/

**Accessibility:**
- WCAG Quick Ref: https://www.w3.org/WAI/WCAG21/quickref/
- WebAIM Contrast Checker: https://webaim.org/resources/contrastchecker/

**Performance:**
- Lighthouse docs: https://developers.google.com/web/tools/lighthouse
- Web.dev metrics: https://web.dev/metrics/

---

## â­ï¸ Next Steps After Story 5.4

Once this story is complete:

1. **Story 5.5:** Event Feed Component
   - Populate event list with real data
   - Connect to WebSocket for live updates
   - Implement infinite scroll

2. **Story 5.6:** System Health Display
   - Populate metrics panel with real data
   - Connect to /api/metrics endpoint
   - Update in real-time

3. **Story 5.7:** Event Detail Modal
   - Implement modal open/close
   - Load event details on click
   - Display annotated image

---

## ðŸ“ Definition of Done

Before marking this story complete, verify:

### Implementation
- [ ] All 12 acceptance criteria met
- [ ] HTML structure complete
- [ ] CSS Grid layout implemented
- [ ] Dark mode applied
- [ ] Component styles complete
- [ ] Loading states implemented
- [ ] Accessibility features added

### Testing
- [ ] Visual testing checklist complete
- [ ] Responsive testing (3 breakpoints)
- [ ] Accessibility testing (keyboard + screen reader)
- [ ] Performance testing (Lighthouse >90)
- [ ] Browser compatibility (Chrome, Safari, Firefox)

### Quality
- [ ] Code reviewed and approved
- [ ] No linting errors
- [ ] CSS minified
- [ ] No unused CSS rules
- [ ] Comments for complex styles

### Documentation
- [ ] README updated with design system
- [ ] Color palette documented
- [ ] Component examples provided
- [ ] Responsive breakpoints documented

### Integration
- [ ] Replaces placeholder index.html
- [ ] No breaking changes to 5.1-5.3
- [ ] Static files served correctly
- [ ] Dashboard loads on localhost:8000

---

**Estimated Time Breakdown:**
- HTML structure: 30 min
- CSS variables & reset: 30 min
- Grid layout: 60 min
- Component styles: 90 min
- Loading states: 30 min
- Accessibility: 30 min
- Performance optimization: 30 min
- Browser testing: 30 min
- Manual testing: 60 min
- Documentation: 30 min
- **Total: 7-8 hours**

Good luck! ðŸš€
