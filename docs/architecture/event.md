# Event

**Purpose:** Represents a single motion-triggered event captured from the camera, processed through the pipeline, and persisted to storage. This is the core entity in the system, containing all information about detected objects and semantic descriptions.

**Key Attributes:**
- `event_id` (str): Unique identifier, format: `evt_<timestamp>_<random>` (e.g., `evt_1699459335_a7b3c`)
- `timestamp` (datetime): When the event occurred (UTC with timezone awareness)
- `camera_id` (str): Identifier for the camera source (future multi-camera support)
- `motion_confidence` (float | None): Motion detection confidence score (0.0-1.0)
- `detected_objects` (list[DetectedObject]): All objects detected by CoreML
- `llm_description` (str): Semantic description generated by Ollama LLM
- `image_path` (str): Path to annotated image with bounding boxes (relative to project root)
- `json_log_path` (str): Path to JSON log file containing this event
- `created_at` (datetime): Database insertion timestamp (auto-generated)

## Pydantic Schema

```python
from pydantic import BaseModel, Field
from datetime import datetime
from typing import List, Optional

class Event(BaseModel):
    """Core event entity representing a motion-triggered detection."""

    event_id: str = Field(
        ...,
        description="Unique event identifier",
        example="evt_1699459335_a7b3c"
    )
    timestamp: datetime = Field(
        ...,
        description="Event occurrence time (UTC)",
        example="2025-11-08T14:32:15Z"
    )
    camera_id: str = Field(
        ...,
        description="Camera identifier",
        example="front_door"
    )
    motion_confidence: Optional[float] = Field(
        None,
        ge=0.0,
        le=1.0,
        description="Motion detection confidence score"
    )
    detected_objects: List['DetectedObject'] = Field(
        default_factory=list,
        description="Objects detected by CoreML"
    )
    llm_description: str = Field(
        ...,
        description="Semantic description from Ollama LLM",
        example="Person in blue shirt carrying brown package approaching front door"
    )
    image_path: str = Field(
        ...,
        description="Path to annotated image",
        example="data/events/2025-11-08/evt_1699459335_a7b3c.jpg"
    )
    json_log_path: str = Field(
        ...,
        description="Path to JSON log file",
        example="data/events/2025-11-08/events.json"
    )
    created_at: datetime = Field(
        default_factory=datetime.utcnow,
        description="Database insertion timestamp"
    )

    class Config:
        json_schema_extra = {
            "example": {
                "event_id": "evt_1699459335_a7b3c",
                "timestamp": "2025-11-08T14:32:15Z",
                "camera_id": "front_door",
                "motion_confidence": 0.87,
                "detected_objects": [
                    {"label": "person", "confidence": 0.92, "bbox": {"x": 120, "y": 50, "width": 180, "height": 320}},
                    {"label": "package", "confidence": 0.87, "bbox": {"x": 150, "y": 280, "width": 80, "height": 60}}
                ],
                "llm_description": "Person in blue shirt carrying brown package approaching front door",
                "image_path": "data/events/2025-11-08/evt_1699459335_a7b3c.jpg",
                "json_log_path": "data/events/2025-11-08/events.json",
                "created_at": "2025-11-08T14:32:16Z"
            }
        }
```

## Relationships
- **Has many** DetectedObject instances (1:N relationship)
- **Belongs to** Camera (future Phase 3 multi-camera support)
- **References** image file and JSON log file on filesystem

---
